(function(f){f.fn.nthTabs=function(l){var b=this,m={allowClose:!0,active:!1,rollWidth:b.width()-120},g=f.extend({},m,l),c={init:function(){b.html('<div class="page-tabs">\t\t\t\t<a href="#" class="roll-nav roll-nav-left" > <span class="fa fa-backward"></span></a>\t\t\t\t<div class="content-tabs">\t\t\t\t\t<div class="content-tabs-container">\t\t\t\t\t\t<ul class="nav nav-tabs"></ul>\t\t\t\t\t</div>\t\t\t\t</div>\t\t\t\t<a href="#" class="roll-nav roll-nav-right"><span class="fa fa-forward"></span></a>\t\t\t\t<div class="dropdown roll-nav right-nav-list">\t\t\t\t\t<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">\t\t\t\t\t\t<span class="fa fa-chevron-down"></span>\t\t\t\t\t</a>\t\t\t\t\t<ul class="dropdown-menu">\t\t\t\t\t\t<li><a href="#" class="tab-location"><i class="fa fa-map-marker m-r-xs"></i>\u5b9a\u4f4d\u5f53\u524d\u9009\u9879\u5361</a></li>\t\t\t\t\t\t<li><a href="#" class="tab-close-current"><i class="fa fa-minus-circle m-r-xs"></i>\u5173\u95ed\u5f53\u524d\u9009\u9879\u5361</a></li>\t\t\t\t\t\t<li role="separator" class="divider"></li>\t\t\t\t\t\t<li><a href="#" class="tab-close-other"><i class="fa fa-minus-circle m-r-xs"></i>\u5173\u95ed\u5176\u4ed6\u9009\u9879\u5361</a></li>\t\t\t\t\t\t<li><a href="#" class="tab-close-all"><i class="fa fa-minus-circle m-r-xs"></i>\u5173\u95ed\u5168\u90e8\u9009\u9879\u5361</a></li>\t\t\t\t\t\t<li role="separator" class="divider"></li>\t\t\t\t\t\t<li class="scrollbar-outer tab-list-scrollbar">\t\t\t\t\t\t\t<div class="tab-list-container">\t\t\t\t\t\t\t\t<ul class="tab-list"></ul>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</li>\t\t\t\t\t</ul>\t\t\t\t</div>\t\t\t</div>\t\t\t<div class="tab-content"></div>');
c.listen()},listen:function(){d.onTabClose().onTabDbClose().onTabRollLeft().onTabRollRight().onTabList().onTabCloseOpt().onTabCloseAll().onTabCloseOther().onLocationTab().onTabRefresh()},getAllTabWidth:function(){var a=0;b.find(".nav-tabs li").each(function(){a+=parseFloat(f(this).width())});return a},getMarginStep:function(){return g.rollWidth/2},getActiveId:function(){return b.find('li[class="active"]').find("a").attr("href").replace("#","")},getTabList:function(){var a=[];b.find(".nav-tabs li a").each(function(){a.push({id:f(this).attr("href"),
title:f(this).children("span").html()})});return a},addTab:function(a){var h="#"+a.id;if(0<b.find("[href='"+h+"']").length)c.setActTab(h);else{var e=[],d=void 0==a.active?g.active:a.active,k=void 0==a.allowClose?g.allowClose:a.allowClose;d=d?"active":"";e.push('<li role="presentation" class="'+d+'">');k?e.push('<a href="#'+a.id+'" class="tab-db-close" data-toggle="tab">'):e.push('<a href="#'+a.id+'" data-toggle="tab">');e.push("<span>"+a.title+"</span>");k?e.push('<i class="fa fa-minus-square tab-close"></i>'):
"";e.push("</a>");e.push("</li>");b.find(".nav-tabs").append(e.join(""));e=[];e.push('<div class="tab-pane '+d+'" id="'+a.id+'">');e.push('<iframe src="'+a.href+'" scrolling="no" frameborder="0"></iframe>');e.push("</div>");b.find(".tab-content").append(e.join(""));f(b.find("[href='"+h+"']")).contextmenu(function(a){a.preventDefault();c.refreshTab(h)})}return c},locationTab:function(a){a=void 0==a?c.getActiveId():a;a=-1<a.indexOf("#")?a:"#"+a;a=b.find("[href='"+a+"']");var h=0;a.parent().prevAll().each(function(){h+=
f(this).width()});var e=a.parent().parent().parent();margin_left_total=h<=.7*g.rollWidth?40:h<=g.rollWidth?40-g.rollWidth/2:h+a.parent().width()-Math.floor(h/g.rollWidth)*g.rollWidth<=.7*g.rollWidth?40-Math.floor(h/g.rollWidth)*g.rollWidth:40-Math.floor(h/g.rollWidth)*g.rollWidth-g.rollWidth/2;e.css("margin-left",margin_left_total);return c},refreshTab:function(a){a=void 0==a?c.getActiveId():a;a=-1<a.indexOf("#")?a:"#"+a;f("iframe",a).get(0).contentWindow.location.reload(!0);return c},delTab:function(a){a=
void 0==a?c.getActiveId():a;a=-1<a.indexOf("#")?a:"#"+a;var h=b.find("[href='"+a+"']");if("active"==h.parent().attr("class")){var e=h.parent().next(),d=f(a).next();1>e.length&&(e=h.parent().prev(),d=f(a).prev());e.addClass("active");d.addClass("active")}h.parent().remove();f(a).remove();return c},delOtherTab:function(){b.find(".nav-tabs li").not('[class="active"]').remove();b.find(".tab-content div").not('[class="tab-pane active"]').remove();return c},delAllTab:function(){b.find(".nav-tabs li").remove();
b.find(".tab-content div").remove();return c},setActTab:function(a){a=void 0==a?c.getActiveId():a;a=-1<a.indexOf("#")?a:"#"+a;b.find(".active").removeClass("active");b.find("[href='"+a+"']").parent().addClass("active");b.find(a).addClass("active");return c}},d={onLocationTab:function(){b.on("click",".tab-location",function(){c.locationTab()});return d},onTabRefresh:function(){b.on("click",".tab-refresh",function(){var a=f(this).parent().attr("href");c.refreshTab(a)});return d},onTabClose:function(){b.on("click",
".tab-close",function(){var a=f(this).parent().attr("href");c.delTab(a)});return d},onTabDbClose:function(){b.on("dblclick",".tab-db-close",function(){var a=f(this).parent().attr("href");c.delTab(a)});return d},onTabCloseOpt:function(){b.on("click",".tab-close-current",function(){c.delTab()});return d},onTabCloseOther:function(){b.on("click",".tab-close-other",function(){c.delOtherTab()});return d},onTabCloseAll:function(){b.on("click",".tab-close-all",function(){c.delAllTab()});return d},onTabRollLeft:function(){b.on("click",
".roll-nav-left",function(){if(c.getAllTabWidth()<=g.rollWidth)return!1;var a=f(this).parent().find(".content-tabs-container"),b=a.css("marginLeft").replace("px","");b=parseFloat(b)+c.getMarginStep()+40;a.css("margin-left",40<b?40:b)});return d},onTabRollRight:function(){b.on("click",".roll-nav-right",function(){if(c.getAllTabWidth()<=g.rollWidth)return!1;var a=f(this).parent().find(".content-tabs-container"),b=a.css("marginLeft").replace("px",""),e=parseFloat(b)-c.getMarginStep();if(c.getAllTabWidth()-
Math.abs(b)<=g.rollWidth)return!1;a.css("margin-left",e)});return d},onTabList:function(){b.on("click",".right-nav-list",function(){var a=c.getTabList(),d=[];f.each(a,function(a,b){d.push('<li class="toggle-tab" data-id="'+b.id+'">'+b.title+"</li>")});b.find(".tab-list").html(d.join(""))});b.find(".tab-list-scrollbar").scrollbar();d.onTabListToggle();return d},onTabListToggle:function(){b.on("click",".toggle-tab",function(){var a=f(this).data("id");c.setActTab(a).locationTab(a)});return d}};c.init();
return c}})(jQuery);
