(function(f){"function"===typeof require&&"object"===typeof exports&&"object"===typeof module?module.exports=f:"function"===typeof define?define.amd||define(["jquery"],f):window.editormd=f()})(function(){var f="undefined"!==typeof jQuery?jQuery:Zepto;if("undefined"!==typeof f){var d=function(a,b){return new d.fn.init(a,b)};d.title=d.$name="Editor.md";d.version="1.5.0";d.homePage="https://pandao.github.io/editor.md/";d.classPrefix="editormd-";d.toolbarModes={full:"undo redo | bold del italic quote ucwords uppercase lowercase | h1 h2 h3 h4 h5 h6 | list-ul list-ol hr | link reference-link image code preformatted-text code-block table datetime emoji html-entities pagebreak | goto-line watch preview fullscreen clear search | gears help info".split(" "),
simple:"undo redo | bold del italic quote uppercase lowercase | h1 h2 h3 h4 h5 h6 | list-ul list-ol hr | watch preview fullscreen | gears help info".split(" "),mini:"undo redo | watch preview | gears help info".split(" ")};d.defaults={mode:"gfm",name:"",value:"",theme:"",editorTheme:"default",previewTheme:"",markdown:"",appendMarkdown:"",width:"100%",height:"100%",path:"./lib/",pluginPath:"",delay:300,autoLoadModules:!0,watch:!0,placeholder:"Enjoy Markdown! coding now...",gotoLine:!0,codeFold:!1,
autoHeight:!1,autoFocus:!0,autoCloseTags:!0,searchReplace:!0,syncScrolling:!0,readOnly:!1,tabSize:4,indentUnit:4,lineNumbers:!0,lineWrapping:!0,autoCloseBrackets:!0,showTrailingSpace:!0,matchBrackets:!0,indentWithTabs:!0,styleSelectedText:!0,matchWordHighlight:!0,styleActiveLine:!0,dialogLockScreen:!0,dialogShowMask:!0,dialogDraggable:!0,dialogMaskBgColor:"#fff",dialogMaskOpacity:.1,fontSize:"13px",saveHTMLToTextarea:!1,disabledKeyMaps:[],onload:function(){},onresize:function(){},onchange:function(){},
onwatch:null,onunwatch:null,onpreviewing:function(){},onpreviewed:function(){},onfullscreen:function(){},onfullscreenExit:function(){},onscroll:function(){},onpreviewscroll:function(){},imageUpload:!1,imageFormats:"jpg jpeg gif png bmp webp".split(" "),imageUploadURL:"",crossDomainUpload:!1,uploadCallbackURL:"",toc:!0,tocm:!1,tocTitle:"",tocDropdown:!1,tocContainer:"",tocStartLevel:1,htmlDecode:!1,pageBreak:!0,atLink:!0,emailLink:!0,taskList:!1,emoji:!1,tex:!1,flowChart:!1,sequenceDiagram:!1,previewCodeHighlight:!0,
toolbar:!0,toolbarAutoFixed:!0,toolbarIcons:"full",toolbarTitles:{},toolbarHandlers:{ucwords:function(){return d.toolbarHandlers.ucwords},lowercase:function(){return d.toolbarHandlers.lowercase}},toolbarCustomIcons:{lowercase:'<a href="javascript:;" title="Lowercase" unselectable="on"><i class="fa" name="lowercase" style="font-size:24px;margin-top: -10px;">a</i></a>',ucwords:'<a href="javascript:;" title="ucwords" unselectable="on"><i class="fa" name="ucwords" style="font-size:20px;margin-top: -3px;">Aa</i></a>'},
toolbarIconsClass:{undo:"fa-undo",redo:"fa-repeat",bold:"fa-bold",del:"fa-strikethrough",italic:"fa-italic",quote:"fa-quote-left",uppercase:"fa-font",h1:d.classPrefix+"bold",h2:d.classPrefix+"bold",h3:d.classPrefix+"bold",h4:d.classPrefix+"bold",h5:d.classPrefix+"bold",h6:d.classPrefix+"bold","list-ul":"fa-list-ul","list-ol":"fa-list-ol",hr:"fa-minus",link:"fa-link","reference-link":"fa-anchor",image:"fa-picture-o",code:"fa-code","preformatted-text":"fa-file-code-o","code-block":"fa-file-code-o",
table:"fa-table",datetime:"fa-clock-o",emoji:"fa-smile-o","html-entities":"fa-copyright",pagebreak:"fa-newspaper-o","goto-line":"fa-terminal",watch:"fa-eye-slash",unwatch:"fa-eye",preview:"fa-desktop",search:"fa-search",fullscreen:"fa-arrows-alt",clear:"fa-eraser",gears:"fa-gears",help:"fa-question-circle",info:"fa-info-circle"},toolbarIconTexts:{},lang:{name:"zh-cn",description:"\u5f00\u6e90\u5728\u7ebfMarkdown\u7f16\u8f91\u5668<br/>Open source online Markdown editor.",tocTitle:"\u76ee\u5f55",toolbar:{undo:"\u64a4\u9500\uff08Ctrl+Z\uff09",
redo:"\u91cd\u505a\uff08Ctrl+Y\uff09",bold:"\u7c97\u4f53",del:"\u5220\u9664\u7ebf",italic:"\u659c\u4f53",quote:"\u5f15\u7528",ucwords:"\u5c06\u6bcf\u4e2a\u5355\u8bcd\u9996\u5b57\u6bcd\u8f6c\u6210\u5927\u5199",uppercase:"\u5c06\u6240\u9009\u8f6c\u6362\u6210\u5927\u5199",lowercase:"\u5c06\u6240\u9009\u8f6c\u6362\u6210\u5c0f\u5199",h1:"\u6807\u98981",h2:"\u6807\u98982",h3:"\u6807\u98983",h4:"\u6807\u98984",h5:"\u6807\u98985",h6:"\u6807\u98986","list-ul":"\u65e0\u5e8f\u5217\u8868","list-ol":"\u6709\u5e8f\u5217\u8868",
hr:"\u6a2a\u7ebf",link:"\u94fe\u63a5","reference-link":"\u5f15\u7528\u94fe\u63a5",image:"\u6dfb\u52a0\u56fe\u7247",code:"\u884c\u5185\u4ee3\u7801","preformatted-text":"\u9884\u683c\u5f0f\u6587\u672c / \u4ee3\u7801\u5757\uff08\u7f29\u8fdb\u98ce\u683c\uff09","code-block":"\u4ee3\u7801\u5757\uff08\u591a\u8bed\u8a00\u98ce\u683c\uff09",table:"\u6dfb\u52a0\u8868\u683c",datetime:"\u65e5\u671f\u65f6\u95f4",emoji:"Emoji\u8868\u60c5","html-entities":"HTML\u5b9e\u4f53\u5b57\u7b26",pagebreak:"\u63d2\u5165\u5206\u9875\u7b26",
"goto-line":"\u8df3\u8f6c\u5230\u884c",watch:"\u5173\u95ed\u5b9e\u65f6\u9884\u89c8",unwatch:"\u5f00\u542f\u5b9e\u65f6\u9884\u89c8",preview:"\u5168\u7a97\u53e3\u9884\u89c8HTML\uff08\u6309 Shift + ESC\u8fd8\u539f\uff09",fullscreen:"\u5168\u5c4f\uff08\u6309ESC\u8fd8\u539f\uff09",clear:"\u6e05\u7a7a",search:"\u641c\u7d22",gears:"\u6a21\u677f\u6269\u5c55",help:"\u4f7f\u7528\u5e2e\u52a9",info:"\u5173\u4e8e"+d.title},buttons:{enter:"\u786e\u5b9a",cancel:"\u53d6\u6d88",close:"\u5173\u95ed"},dialog:{link:{title:"\u6dfb\u52a0\u94fe\u63a5",
url:"\u94fe\u63a5\u5730\u5740",urlTitle:"\u94fe\u63a5\u6807\u9898",urlEmpty:"\u9519\u8bef\uff1a\u8bf7\u586b\u5199\u94fe\u63a5\u5730\u5740\u3002"},referenceLink:{title:"\u6dfb\u52a0\u5f15\u7528\u94fe\u63a5",name:"\u5f15\u7528\u540d\u79f0",url:"\u94fe\u63a5\u5730\u5740",urlId:"\u94fe\u63a5ID",urlTitle:"\u94fe\u63a5\u6807\u9898",nameEmpty:"\u9519\u8bef\uff1a\u5f15\u7528\u94fe\u63a5\u7684\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a\u3002",idEmpty:"\u9519\u8bef\uff1a\u8bf7\u586b\u5199\u5f15\u7528\u94fe\u63a5\u7684ID\u3002",
urlEmpty:"\u9519\u8bef\uff1a\u8bf7\u586b\u5199\u5f15\u7528\u94fe\u63a5\u7684URL\u5730\u5740\u3002"},image:{title:"\u6dfb\u52a0\u56fe\u7247",url:"\u56fe\u7247\u5730\u5740",link:"\u56fe\u7247\u94fe\u63a5",alt:"\u56fe\u7247\u63cf\u8ff0",uploadButton:"\u672c\u5730\u4e0a\u4f20",imageURLEmpty:"\u9519\u8bef\uff1a\u56fe\u7247\u5730\u5740\u4e0d\u80fd\u4e3a\u7a7a\u3002",uploadFileEmpty:"\u9519\u8bef\uff1a\u4e0a\u4f20\u7684\u56fe\u7247\u4e0d\u80fd\u4e3a\u7a7a\u3002",formatNotAllowed:"\u9519\u8bef\uff1a\u53ea\u5141\u8bb8\u4e0a\u4f20\u56fe\u7247\u6587\u4ef6\uff0c\u5141\u8bb8\u4e0a\u4f20\u7684\u56fe\u7247\u6587\u4ef6\u683c\u5f0f\u6709\uff1a"},
preformattedText:{title:"\u6dfb\u52a0\u9884\u683c\u5f0f\u6587\u672c\u6216\u4ee3\u7801\u5757",emptyAlert:"\u9519\u8bef\uff1a\u8bf7\u586b\u5199\u9884\u683c\u5f0f\u6587\u672c\u6216\u4ee3\u7801\u7684\u5185\u5bb9\u3002"},codeBlock:{title:"\u6dfb\u52a0\u4ee3\u7801\u5757",selectLabel:"\u4ee3\u7801\u8bed\u8a00\uff1a",selectDefaultText:"\u8bf7\u9009\u62e9\u4ee3\u7801\u8bed\u8a00",otherLanguage:"\u5176\u4ed6\u8bed\u8a00",unselectedLanguageAlert:"\u9519\u8bef\uff1a\u8bf7\u9009\u62e9\u4ee3\u7801\u6240\u5c5e\u7684\u8bed\u8a00\u7c7b\u578b\u3002",
codeEmptyAlert:"\u9519\u8bef\uff1a\u8bf7\u586b\u5199\u4ee3\u7801\u5185\u5bb9\u3002"},htmlEntities:{title:"HTML \u5b9e\u4f53\u5b57\u7b26"},gears:{title:"\u6a21\u677f\u6269\u5c55"},help:{title:"\u4f7f\u7528\u5e2e\u52a9"}}}};d.classNames={tex:d.classPrefix+"tex"};d.dialogZindex=99999;d.$katex=null;d.$marked=null;d.$CodeMirror=null;d.$prettyPrint=null;var u,v;d.prototype=d.fn={state:{watching:!1,loaded:!1,preview:!1,fullscreen:!1},init:function(a,b){b=b||{};"object"===typeof a&&(b=a);var c=this.classPrefix=
d.classPrefix;b=this.settings=f.extend(!0,{},d.defaults,b);a="object"===typeof a?b.id:a;var e=this.editor=f("#"+a);this.id=a;this.lang=b.lang;var h=this.classNames={textarea:{html:c+"html-textarea",markdown:c+"markdown-textarea"}};b.pluginPath=""===b.pluginPath?b.path+"../plugins/":b.pluginPath;this.state.watching=b.watch?!0:!1;e.hasClass("editormd")||e.addClass("editormd");e.css({width:"number"===typeof b.width?b.width+"px":b.width,height:"number"===typeof b.height?b.height+"px":b.height});b.autoHeight&&
e.css("height","auto");var k=this.markdownTextarea=e.children("textarea");1>k.length&&(e.append("<textarea></textarea>"),k=this.markdownTextarea=e.children("textarea"));k.addClass(h.textarea.markdown).attr("placeholder",b.placeholder);"undefined"!==typeof k.attr("name")&&""!==k.attr("name")||k.attr("name",""!==b.name?b.name:a+"-markdown-doc");a=[b.readOnly?"":'<a href="javascript:;" class="fa fa-close '+c+'preview-close-btn"></a>',b.saveHTMLToTextarea?'<textarea class="'+h.textarea.html+'" name="'+
a+'-html-code"></textarea>':"",'<div class="'+c+'preview"><div class="markdown-body '+c+'preview-container"></div></div>','<div class="'+c+'container-mask" style="display:block;"></div>','<div class="'+c+'mask"></div>'].join("\n");e.append(a).addClass(c+"vertical");""!==b.theme&&e.addClass(c+"theme-"+b.theme);this.mask=e.children("."+c+"mask");this.containerMask=e.children("."+c+"container-mask");""!==b.markdown&&k.val(b.markdown);""!==b.appendMarkdown&&k.val(k.val()+b.appendMarkdown);this.htmlTextarea=
e.children("."+h.textarea.html);this.preview=e.children("."+c+"preview");this.previewContainer=this.preview.children("."+c+"preview-container");""!==b.previewTheme&&this.preview.addClass(c+"preview-theme-"+b.previewTheme);"function"===typeof define&&define.amd&&("undefined"!==typeof katex&&(d.$katex=katex),b.searchReplace&&!b.readOnly&&(d.loadCSS(b.path+"codemirror/addon/dialog/dialog"),d.loadCSS(b.path+"codemirror/addon/search/matchesonscrollbar")));"function"===typeof define&&define.amd||!b.autoLoadModules?
("undefined"!==typeof CodeMirror&&(d.$CodeMirror=CodeMirror),"undefined"!==typeof marked&&(d.$marked=marked),this.setCodeMirror().setToolbar().loadedDisplay()):this.loadQueues();return this},loadQueues:function(){var a=this,b=this.settings,c=b.path,e=function(){d.isIE8?a.loadedDisplay():b.flowChart||b.sequenceDiagram?d.loadScript(c+"raphael.min",function(){d.loadScript(c+"underscore.min",function(){!b.flowChart&&b.sequenceDiagram?d.loadScript(c+"sequence-diagram.min",function(){a.loadedDisplay()}):
b.flowChart&&!b.sequenceDiagram?d.loadScript(c+"flowchart.min",function(){d.loadScript(c+"jquery.flowchart.min",function(){a.loadedDisplay()})}):b.flowChart&&b.sequenceDiagram&&d.loadScript(c+"flowchart.min",function(){d.loadScript(c+"jquery.flowchart.min",function(){d.loadScript(c+"sequence-diagram.min",function(){a.loadedDisplay()})})})})}):a.loadedDisplay()};d.loadCSS(c+"codemirror/codemirror.min");b.searchReplace&&!b.readOnly&&(d.loadCSS(c+"codemirror/addon/dialog/dialog"),d.loadCSS(c+"codemirror/addon/search/matchesonscrollbar"));
b.codeFold&&d.loadCSS(c+"codemirror/addon/fold/foldgutter");d.loadScript(c+"codemirror/codemirror.min",function(){d.$CodeMirror=CodeMirror;d.loadScript(c+"codemirror/modes.min",function(){d.loadScript(c+"codemirror/addons.min",function(){a.setCodeMirror();if("gfm"!==b.mode&&"markdown"!==b.mode)return a.loadedDisplay(),!1;a.setToolbar();d.loadScript(c+"marked.min",function(){d.$marked=marked;b.previewCodeHighlight?d.loadScript(c+"prettify.min",function(){e()}):e()})})})});return this},setTheme:function(a){var b=
this.classPrefix+"theme-";this.editor.removeClass(b+this.settings.theme).addClass(b+a);this.settings.theme=a;return this},setEditorTheme:function(a){var b=this.settings;b.editorTheme=a;"default"!==a&&d.loadCSS(b.path+"codemirror/theme/"+b.editorTheme);this.cm.setOption("theme",a);return this},setCodeMirrorTheme:function(a){this.setEditorTheme(a);return this},setPreviewTheme:function(a){var b=this.classPrefix+"preview-theme-";this.preview.removeClass(b+this.settings.previewTheme).addClass(b+a);this.settings.previewTheme=
a;return this},setCodeMirror:function(){var a=this.settings,b=this.editor;"default"!==a.editorTheme&&d.loadCSS(a.path+"codemirror/theme/"+a.editorTheme);this.codeEditor=this.cm=d.$CodeMirror.fromTextArea(this.markdownTextarea[0],{mode:a.mode,theme:a.editorTheme,tabSize:a.tabSize,dragDrop:!1,autofocus:a.autoFocus,autoCloseTags:a.autoCloseTags,readOnly:a.readOnly?"nocursor":!1,indentUnit:a.indentUnit,lineNumbers:a.lineNumbers,lineWrapping:a.lineWrapping,extraKeys:{"Ctrl-Q":function(a){a.foldCode(a.getCursor())}},
foldGutter:a.codeFold,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],matchBrackets:a.matchBrackets,indentWithTabs:a.indentWithTabs,styleActiveLine:a.styleActiveLine,styleSelectedText:a.styleSelectedText,autoCloseBrackets:a.autoCloseBrackets,showTrailingSpace:a.showTrailingSpace,highlightSelectionMatches:a.matchWordHighlight?{showToken:"onselected"===a.matchWordHighlight?!1:/\w/}:!1});this.codeMirror=this.cmElement=b.children(".CodeMirror");""!==a.value&&this.cm.setValue(a.value);this.codeMirror.css({fontSize:a.fontSize,
width:a.watch?"50%":"100%"});a.autoHeight&&(this.codeMirror.css("height","auto"),this.cm.setOption("viewportMargin",Infinity));a.lineNumbers||this.codeMirror.find(".CodeMirror-gutters").css("border-right","none");return this},getCodeMirrorOption:function(a){return this.cm.getOption(a)},setCodeMirrorOption:function(a,b){this.cm.setOption(a,b);return this},addKeyMap:function(a,b){this.cm.addKeyMap(a,b);return this},removeKeyMap:function(a){this.cm.removeKeyMap(a);return this},gotoLine:function(a){var b=
this.settings;if(!b.gotoLine)return this;var c=this.cm,e=c.lineCount(),d=this.preview;"string"===typeof a&&("last"===a&&(a=e),"first"===a&&(a=1));if("number"!==typeof a)return alert("Error: The line number must be an integer."),this;a=parseInt(a)-1;if(a>e)return alert("Error: The line number range 1-"+e),this;c.setCursor({line:a,ch:0});e=c.getScrollInfo().clientHeight;a=c.charCoords({line:a,ch:0},"local");c.scrollTo(null,(a.top+a.bottom-e)/2);if(b.watch){b=this.codeMirror.find(".CodeMirror-scroll")[0];
a=f(b).height();e=b.scrollTop;var k=e/b.scrollHeight;0===e?d.scrollTop(0):e+a>=b.scrollHeight-16?d.scrollTop(d[0].scrollHeight):d.scrollTop(d[0].scrollHeight*k)}c.focus();return this},extend:function(a,b){"undefined"!==typeof b&&("function"===typeof b&&(b=f.proxy(b,this)),this[a]=b);"object"===typeof a&&"undefined"===typeof a.length&&f.extend(!0,this,a);return this},set:function(a,b){"undefined"!==typeof b&&"function"===typeof b&&(b=f.proxy(b,this));this[a]=b;return this},config:function(a,b){var c=
this.settings;"object"===typeof a&&(c=f.extend(!0,c,a));"string"===typeof a&&(c[a]=b);this.settings=c;this.recreate();return this},on:function(a,b){var c=this.settings;"undefined"!==typeof c["on"+a]&&(c["on"+a]=f.proxy(b,this));return this},off:function(a){var b=this.settings;"undefined"!==typeof b["on"+a]&&(b["on"+a]=function(){});return this},showToolbar:function(a){var b=this.settings;if(b.readOnly)return this;b.toolbar&&(1>this.toolbar.length||""===this.toolbar.find("."+this.classPrefix+"menu").html())&&
this.setToolbar();b.toolbar=!0;this.toolbar.show();this.resize();f.proxy(a||function(){},this)();return this},hideToolbar:function(a){this.settings.toolbar=!1;this.toolbar.hide();this.resize();f.proxy(a||function(){},this)();return this},setToolbarAutoFixed:function(a){var b=this.state,c=this.editor,e=this.toolbar,d=this.settings;"undefined"!==typeof a&&(d.toolbarAutoFixed=a);a=function(){var a=f(window),b=a.scrollTop();if(!d.toolbarAutoFixed)return!1;10<b-c.offset().top&&b<c.height()?e.css({position:"fixed",
width:c.width()+"px",left:(a.width()-c.width())/2+"px"}):e.css({position:"absolute",width:"100%",left:0})};!b.fullscreen&&!b.preview&&d.toolbar&&d.toolbarAutoFixed&&f(window).bind("scroll",a);return this},setToolbar:function(){var a=this.settings;if(a.readOnly)return this;var b=this.editor,c=this.classPrefix,e=this.toolbar=b.children("."+c+"toolbar");a.toolbar&&1>e.length&&(b.append('<div class="'+c+'toolbar"><div class="'+c+'toolbar-container"><ul class="'+c+'menu"></ul></div></div>'),e=this.toolbar=
b.children("."+c+"toolbar"));if(!a.toolbar)return e.hide(),this;e.show();b="function"===typeof a.toolbarIcons?a.toolbarIcons():"string"===typeof a.toolbarIcons?d.toolbarModes[a.toolbarIcons]:a.toolbarIcons;e=e.find("."+this.classPrefix+"menu");c="";for(var f=!1,k=0,l=b.length;k<l;k++){var g=b[k];if("||"===g)f=!0;else if("|"===g)c+='<li class="divider" unselectable="on">|</li>';else{var n=/h(\d)/.test(g),p=g;"watch"!==g||a.watch||(p="unwatch");var q=a.lang.toolbar[p],m=a.toolbarIconTexts[p];p=a.toolbarIconsClass[p];
q="undefined"===typeof q?"":q;m="undefined"===typeof m?"":m;p="undefined"===typeof p?"":p;var r=f?'<li class="pull-right">':"<li>";"undefined"!==typeof a.toolbarCustomIcons[g]&&"function"!==typeof a.toolbarCustomIcons[g]?r+=a.toolbarCustomIcons[g]:(r+='<a href="javascript:;" title="'+q+'" unselectable="on">',r+='<i class="fa '+p+'" name="'+g+'" unselectable="on">'+(n?g.toUpperCase():""===p?m:"")+"</i>",r+="</a>");r+="</li>";c=f?r+c:c+r}}e.html(c);e.find('[title="Lowercase"]').attr("title",a.lang.toolbar.lowercase);
e.find('[title="ucwords"]').attr("title",a.lang.toolbar.ucwords);this.setToolbarHandler();this.setToolbarAutoFixed();return this},dialogLockScreen:function(){f.proxy(d.dialogLockScreen,this)();return this},dialogShowMask:function(a){f.proxy(d.dialogShowMask,this)(a);return this},getToolbarHandles:function(a){var b=this.toolbarHandlers=d.toolbarHandlers;return a&&"undefined"!==typeof toolbarIconHandlers[a]?b[a]:b},setToolbarHandler:function(){var a=this,b=this.settings;if(!b.toolbar||b.readOnly)return this;
var c=this.cm,e=this.toolbarIcons=this.toolbar.find("."+this.classPrefix+"menu > li > a"),h=this.getToolbarHandles();e.bind(d.mouseOrTouch("click","touchend"),function(d){d=f(this).children(".fa");var e=d.attr("name"),g=c.getCursor(),k=c.getSelection();if(""!==e)return a.activeIcon=d,"undefined"!==typeof h[e]?f.proxy(h[e],a)(c):"undefined"!==typeof b.toolbarHandlers[e]&&f.proxy(b.toolbarHandlers[e],a)(c,d,g,k),"link"!==e&&"reference-link"!==e&&"image"!==e&&"code-block"!==e&&"preformatted-text"!==
e&&"watch"!==e&&"preview"!==e&&"search"!==e&&"fullscreen"!==e&&"info"!==e&&c.focus(),!1});return this},createDialog:function(a){return f.proxy(d.createDialog,this)(a)},createInfoDialog:function(){var a=this,b=this.editor,c=this.classPrefix,e=['<div class="'+c+"dialog "+c+'dialog-info" style="">','<div class="'+c+'dialog-container">','<h1><i class="editormd-logo editormd-logo-lg editormd-logo-color"></i> '+d.title+"<small>v"+d.version+"</small></h1>","<p>"+this.lang.description+"</p>",'<p style="margin: 10px 0 20px 0;"><a href="'+
d.homePage+'" target="_blank">'+d.homePage+' <i class="fa fa-external-link"></i></a></p>','<p style="font-size: 0.85em;">Copyright &copy; 2015 <a href="https://github.com/pandao" target="_blank" class="hover-link">Pandao</a>, The <a href="https://github.com/pandao/editor.md/blob/master/LICENSE" target="_blank" class="hover-link">MIT</a> License.</p>\n</div>','<a href="javascript:;" class="fa fa-close '+c+'dialog-close"></a>',"</div>"].join("\n");b.append(e);b=this.infoDialog=b.children("."+c+"dialog-info");
b.find("."+c+"dialog-close").bind(d.mouseOrTouch("click","touchend"),function(){a.hideInfoDialog()});b.css("border",d.isIE8?"1px solid #ddd":"").css("z-index",d.dialogZindex).show();this.infoDialogPosition();return this},infoDialogPosition:function(){var a=this.infoDialog,b=function(){a.css({top:(f(window).height()-a.height())/2+"px",left:(f(window).width()-a.width())/2+"px"})};b();f(window).resize(b);return this},showInfoDialog:function(){f("html,body").css("overflow-x","hidden");var a=this.settings,
b=this.infoDialog=this.editor.children("."+this.classPrefix+"dialog-info");1>b.length&&this.createInfoDialog();this.lockScreen(!0);this.mask.css({opacity:a.dialogMaskOpacity,backgroundColor:a.dialogMaskBgColor}).show();b.css("z-index",d.dialogZindex).show();this.infoDialogPosition();return this},hideInfoDialog:function(){f("html,body").css("overflow-x","");this.infoDialog.hide();this.mask.hide();this.lockScreen(!1);return this},lockScreen:function(a){d.lockScreen(a);this.resize();return this},recreate:function(){var a=
this.editor,b=this.settings;this.codeMirror.remove();this.setCodeMirror();b.readOnly||(0<a.find(".editormd-dialog").length&&a.find(".editormd-dialog").remove(),b.toolbar&&(this.getToolbarHandles(),this.setToolbar()));this.loadedDisplay(!0);return this},previewCodeHighlight:function(){var a=this.previewContainer;this.settings.previewCodeHighlight&&(a.find("pre").addClass("prettyprint linenums"),"undefined"!==typeof prettyPrint&&prettyPrint());return this},katexRender:function(){if(null===u)return this;
this.previewContainer.find("."+d.classNames.tex).each(function(){var a=f(this);d.$katex.render(a.text(),a[0]);a.find(".katex").css("font-size","1.6em")});return this},flowChartAndSequenceDiagramRender:function(){var a=this.settings,b=this.previewContainer;if(d.isIE8)return this;if(a.flowChart){if(null===v)return this;b.find(".flowchart").flowChart()}a.sequenceDiagram&&b.find(".sequence-diagram").sequenceDiagram({theme:"simple"});a=this.preview;b=this.codeMirror.find(".CodeMirror-scroll");var c=b.height(),
e=b.scrollTop(),h=e/b[0].scrollHeight,k=0;a.find(".markdown-toc-list").each(function(){k+=f(this).height()});var l=a.find(".editormd-toc-menu").height();l=l?l:0;0===e?a.scrollTop(0):e+c>=b[0].scrollHeight-16?a.scrollTop(a[0].scrollHeight):a.scrollTop((a[0].scrollHeight+k+l)*h);return this},registerKeyMaps:function(a){var b=this,c=this.cm,e=d.toolbarHandlers,h=this.settings.disabledKeyMaps;if(a=a||null)for(var k in a)0>f.inArray(k,h)&&c.addKeyMap(a);else{for(var l in d.keyMaps)a=d.keyMaps[l],a="string"===
typeof a?f.proxy(e[a],b):f.proxy(a,b),0>f.inArray(l,["F9","F10","F11"])&&0>f.inArray(l,h)&&(k={},k[l]=a,c.addKeyMap(k));f(window).keydown(function(a){if(0>f.inArray({120:"F9",121:"F10",122:"F11"}[a.keyCode],h))switch(a.keyCode){case 120:return f.proxy(e.watch,b)(),!1;case 121:return f.proxy(e.preview,b)(),!1;case 122:return f.proxy(e.fullscreen,b)(),!1}})}return this},bindScrollEvent:function(){var a=this,b=this.preview,c=this.settings,e=this.codeMirror,h=d.mouseOrTouch;if(!c.syncScrolling)return this;
var k=function(){e.find(".CodeMirror-scroll").bind(h("scroll","touchmove"),function(e){var d=f(this).height(),h=f(this).scrollTop(),g=h/f(this)[0].scrollHeight,t=0;b.find(".markdown-toc-list").each(function(){t+=f(this).height()});var k=b.find(".editormd-toc-menu").height();k=k?k:0;0===h?b.scrollTop(0):h+d>=f(this)[0].scrollHeight-16?b.scrollTop(b[0].scrollHeight):b.scrollTop((b[0].scrollHeight+t+k)*g);f.proxy(c.onscroll,a)(e)})},l=function(){e.find(".CodeMirror-scroll").unbind(h("scroll","touchmove"))},
g=function(){b.bind(h("scroll","touchmove"),function(b){var d=f(this).height(),h=f(this).scrollTop(),g=h/f(this)[0].scrollHeight,t=e.find(".CodeMirror-scroll");0===h?t.scrollTop(0):h+d>=f(this)[0].scrollHeight?t.scrollTop(t[0].scrollHeight):t.scrollTop(t[0].scrollHeight*g);f.proxy(c.onpreviewscroll,a)(b)})},n=function(){b.unbind(h("scroll","touchmove"))};e.bind({mouseover:k,mouseout:l,touchstart:k,touchend:l});if("single"===c.syncScrolling)return this;b.bind({mouseover:g,mouseout:n,touchstart:g,touchend:n});
return this},bindChangeEvent:function(){var a=this,b=this.settings;if(!b.syncScrolling)return this;this.cm.on("change",function(c,e){b.watch&&a.previewContainer.css("padding",b.autoHeight?"20px 20px 50px 40px":"20px");u=setTimeout(function(){clearTimeout(u);a.save();u=null},b.delay)});return this},loadedDisplay:function(a){a=a||!1;var b=this,c=this.editor,e=this.preview,d=this.settings;this.containerMask.hide();this.save();d.watch&&e.show();c.data("oldWidth",c.width()).data("oldHeight",c.height());
this.resize();this.registerKeyMaps();f(window).resize(function(){b.resize()});this.bindScrollEvent().bindChangeEvent();a||f.proxy(d.onload,this)();this.state.loaded=!0;return this},width:function(a){this.editor.css("width","number"===typeof a?a+"px":a);this.resize();return this},height:function(a){this.editor.css("height","number"===typeof a?a+"px":a);this.resize();return this},resize:function(a,b){a=a||null;b=b||null;var c=this.state,e=this.editor,d=this.preview,k=this.toolbar,l=this.settings,g=
this.codeMirror;a&&e.css("width","number"===typeof a?a+"px":a);!l.autoHeight||c.fullscreen||c.preview?(b&&e.css("height","number"===typeof b?b+"px":b),c.fullscreen&&e.height(f(window).height()),l.toolbar&&!l.readOnly?g.css("margin-top",k.height()+1).height(e.height()-k.height()):g.css("margin-top",0).height(e.height())):(e.css("height","auto"),g.css("height","auto"));l.watch?(g.width(e.width()/2),d.width(c.preview?e.width():e.width()/2),this.previewContainer.css("padding",l.autoHeight?"20px 20px 50px 40px":
"20px"),l.toolbar&&!l.readOnly?d.css("top",k.height()+1):d.css("top",0),!l.autoHeight||c.fullscreen||c.preview?(a=l.toolbar&&!l.readOnly?e.height()-k.height():e.height(),d.height(a)):d.height("")):(g.width(e.width()),d.hide());c.loaded&&f.proxy(l.onresize,this)();return this},save:function(){var a=this,b=this.state,c=this.settings;if(null===u&&(c.watch||!b.preview))return this;var e=this.cm,h=e.getValue(),k=this.previewContainer;if("gfm"!==c.mode&&"markdown"!==c.mode)return this.markdownTextarea.val(h),
this;var l=d.$marked,g=this.markdownToC=[],n=this.markedRendererOptions={toc:c.toc,tocm:c.tocm,tocStartLevel:c.tocStartLevel,pageBreak:c.pageBreak,taskList:c.taskList,emoji:c.emoji,tex:c.tex,atLink:c.atLink,emailLink:c.emailLink,flowChart:c.flowChart,sequenceDiagram:c.sequenceDiagram,previewCodeHighlight:c.previewCodeHighlight};n=this.markedOptions={renderer:d.markedRenderer(g,n),gfm:!0,tables:!0,breaks:!0,pedantic:!1,sanitize:c.htmlDecode?!1:!0,smartLists:!0,smartypants:!0};l.setOptions(n);l=d.$marked(h,
n);l=d.filterHTMLTags(l,c.htmlDecode);this.markdownTextarea.text(h);e.save();c.saveHTMLToTextarea&&this.htmlTextarea.text(l);if(c.watch||!c.watch&&b.preview){k.html(l);this.previewCodeHighlight();c.toc&&(e=""===c.tocContainer?k:f(c.tocContainer),h=e.find("."+this.classPrefix+"toc-menu"),e.attr("previewContainer",""===c.tocContainer?"true":"false"),""!==c.tocContainer&&0<h.length&&h.remove(),d.markdownToCRenderer(g,e,c.tocDropdown,c.tocStartLevel),(c.tocDropdown||0<e.find("."+this.classPrefix+"toc-menu").length)&&
d.tocDropdownMenu(e,""!==c.tocTitle?c.tocTitle:this.lang.tocTitle),""!==c.tocContainer&&k.find(".markdown-toc").css("border","none"));c.tex&&(!d.kaTeXLoaded&&c.autoLoadModules?d.loadKaTeX(function(){d.$katex=katex;d.kaTeXLoaded=!0;a.katexRender()}):(d.$katex=katex,this.katexRender()));if(c.flowChart||c.sequenceDiagram)v=setTimeout(function(){clearTimeout(v);a.flowChartAndSequenceDiagramRender();v=null},10);b.loaded&&f.proxy(c.onchange,this)()}return this},focus:function(){this.cm.focus();return this},
setCursor:function(a){this.cm.setCursor(a);return this},getCursor:function(){return this.cm.getCursor()},setSelection:function(a,b){this.cm.setSelection(a,b);return this},getSelection:function(){return this.cm.getSelection()},setSelections:function(a){this.cm.setSelections(a);return this},getSelections:function(){return this.cm.getSelections()},replaceSelection:function(a){this.cm.replaceSelection(a);return this},insertValue:function(a){this.replaceSelection(a);return this},appendMarkdown:function(a){var b=
this.cm;b.setValue(b.getValue()+a);return this},setMarkdown:function(a){this.cm.setValue(a||this.settings.markdown);return this},getMarkdown:function(){return this.cm.getValue()},getValue:function(){return this.cm.getValue()},setValue:function(a){this.cm.setValue(a);return this},clear:function(){this.cm.setValue("");return this},getHTML:function(){return this.settings.saveHTMLToTextarea?this.htmlTextarea.val():(alert("Error: settings.saveHTMLToTextarea == false"),!1)},getTextareaSavedHTML:function(){return this.getHTML()},
getPreviewedHTML:function(){return this.settings.watch?this.previewContainer.html():(alert("Error: settings.watch == false"),!1)},watch:function(a){var b=this.settings;if(0>f.inArray(b.mode,["gfm","markdown"]))return this;this.state.watching=b.watch=!0;this.preview.show();if(this.toolbar){var c=b.toolbarIconsClass.watch,d=b.toolbarIconsClass.unwatch,h=this.toolbar.find(".fa[name=watch]");h.parent().attr("title",b.lang.toolbar.watch);h.removeClass(d).addClass(c)}this.codeMirror.css("border-right",
"1px solid #ddd").width(this.editor.width()/2);u=0;this.save().resize();b.onwatch||(b.onwatch=a||function(){});f.proxy(b.onwatch,this)();return this},unwatch:function(a){var b=this.settings;this.state.watching=b.watch=!1;this.preview.hide();if(this.toolbar){var c=b.toolbarIconsClass.watch,d=b.toolbarIconsClass.unwatch,h=this.toolbar.find(".fa[name=watch]");h.parent().attr("title",b.lang.toolbar.unwatch);h.removeClass(c).addClass(d)}this.codeMirror.css("border-right","none").width(this.editor.width());
this.resize();b.onunwatch||(b.onunwatch=a||function(){});f.proxy(b.onunwatch,this)();return this},show:function(a){a=a||function(){};var b=this;this.editor.show(0,function(){f.proxy(a,b)()});return this},hide:function(a){a=a||function(){};var b=this;this.editor.hide(0,function(){f.proxy(a,b)()});return this},previewing:function(){var a=this,b=this.editor,c=this.preview,e=this.toolbar,h=this.settings,k=this.codeMirror,l=this.previewContainer;if(0>f.inArray(h.mode,["gfm","markdown"]))return this;h.toolbar&&
e&&(e.toggle(),e.find(".fa[name=preview]").toggleClass("active"));k.toggle();e=function(b){b.shiftKey&&27===b.keyCode&&a.previewed()};"none"===k.css("display")?(this.state.preview=!0,this.state.fullscreen&&c.css("background","#fff"),b.find("."+this.classPrefix+"preview-close-btn").show().bind(d.mouseOrTouch("click","touchend"),function(){a.previewed()}),h.watch?l.css("padding",""):this.save(),l.addClass(this.classPrefix+"preview-active"),c.show().css({position:"",top:0,width:b.width(),height:h.autoHeight&&
!this.state.fullscreen?"auto":b.height()}),this.state.loaded&&f.proxy(h.onpreviewing,this)(),f(window).bind("keyup",e)):(f(window).unbind("keyup",e),this.previewed())},previewed:function(){var a=this.editor,b=this.preview,c=this.toolbar,e=this.settings,h=this.previewContainer,k=a.find("."+this.classPrefix+"preview-close-btn");this.state.preview=!1;this.codeMirror.show();e.toolbar&&c.show();b[e.watch?"show":"hide"]();k.hide().unbind(d.mouseOrTouch("click","touchend"));h.removeClass(this.classPrefix+
"preview-active");e.watch&&h.css("padding","20px");b.css({background:null,position:"absolute",width:a.width()/2,height:e.autoHeight&&!this.state.fullscreen?"auto":a.height()-c.height(),top:e.toolbar?c.height():0});this.state.loaded&&f.proxy(e.onpreviewed,this)();return this},fullscreen:function(){var a=this,b=this.state,c=this.editor,d=this.toolbar,h=this.settings,k=this.classPrefix+"fullscreen";d&&d.find(".fa[name=fullscreen]").parent().toggleClass("active");d=function(c){c.shiftKey||27!==c.keyCode||
b.fullscreen&&a.fullscreenExit()};c.hasClass(k)?(f(window).unbind("keyup",d),this.fullscreenExit()):(b.fullscreen=!0,f("html,body").css("overflow","hidden"),c.css({width:f(window).width(),height:f(window).height()}).addClass(k),this.resize(),f.proxy(h.onfullscreen,this)(),f(window).bind("keyup",d));return this},fullscreenExit:function(){var a=this.editor,b=this.settings,c=this.toolbar,d=this.classPrefix+"fullscreen";this.state.fullscreen=!1;c&&c.find(".fa[name=fullscreen]").parent().removeClass("active");
f("html,body").css("overflow","");a.css({width:a.data("oldWidth"),height:a.data("oldHeight")}).removeClass(d);this.resize();f.proxy(b.onfullscreenExit,this)();return this},executePlugin:function(a,b){var c=this,e=this.cm;b=this.settings.pluginPath+b;if("function"===typeof define){if("undefined"===typeof this[a])return alert("Error: "+a+" plugin is not found, you are not load this plugin."),this;this[a](e);return this}0>f.inArray(b,d.loadFiles.plugin)?d.loadPlugin(b,function(){d.loadPlugins[a]=c[a];
c[a](e)}):f.proxy(d.loadPlugins[a],this)(e);return this},search:function(a){var b=this.settings;if(!b.searchReplace)return alert("Error: settings.searchReplace == false"),this;b.readOnly||this.cm.execCommand(a||"find");return this},searchReplace:function(){this.search("replace");return this},searchReplaceAll:function(){this.search("replaceAll");return this}};d.fn.init.prototype=d.fn;d.dialogLockScreen=function(){(this.settings||{dialogLockScreen:!0}).dialogLockScreen&&(f("html,body").css("overflow",
"hidden"),this.resize())};d.dialogShowMask=function(a){var b=this.editor,c=this.settings||{dialogShowMask:!0};a.css({top:(f(window).height()-a.height())/2+"px",left:(f(window).width()-a.width())/2+"px"});c.dialogShowMask&&b.children("."+this.classPrefix+"mask").css("z-index",parseInt(a.css("z-index"))-1).show()};d.toolbarHandlers={undo:function(){this.cm.undo()},redo:function(){this.cm.redo()},bold:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();a.replaceSelection("**"+c+"**");""===c&&
a.setCursor(b.line,b.ch+2)},del:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();a.replaceSelection("~~"+c+"~~");""===c&&a.setCursor(b.line,b.ch+2)},italic:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();a.replaceSelection("*"+c+"*");""===c&&a.setCursor(b.line,b.ch+1)},quote:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();0!==b.ch?(a.setCursor(b.line,0),a.replaceSelection("> "+c),a.setCursor(b.line,b.ch+2)):a.replaceSelection("> "+c)},ucfirst:function(){var a=this.cm,
b=a.getSelection(),c=a.listSelections();a.replaceSelection(d.firstUpperCase(b));a.setSelections(c)},ucwords:function(){var a=this.cm,b=a.getSelection(),c=a.listSelections();a.replaceSelection(d.wordsFirstUpperCase(b));a.setSelections(c)},uppercase:function(){var a=this.cm,b=a.getSelection(),c=a.listSelections();a.replaceSelection(b.toUpperCase());a.setSelections(c)},lowercase:function(){var a=this.cm;a.getCursor();var b=a.getSelection(),c=a.listSelections();a.replaceSelection(b.toLowerCase());a.setSelections(c)},
h1:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();0!==b.ch?(a.setCursor(b.line,0),a.replaceSelection("# "+c),a.setCursor(b.line,b.ch+2)):a.replaceSelection("# "+c)},h2:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();0!==b.ch?(a.setCursor(b.line,0),a.replaceSelection("## "+c),a.setCursor(b.line,b.ch+3)):a.replaceSelection("## "+c)},h3:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();0!==b.ch?(a.setCursor(b.line,0),a.replaceSelection("### "+c),a.setCursor(b.line,
b.ch+4)):a.replaceSelection("### "+c)},h4:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();0!==b.ch?(a.setCursor(b.line,0),a.replaceSelection("#### "+c),a.setCursor(b.line,b.ch+5)):a.replaceSelection("#### "+c)},h5:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();0!==b.ch?(a.setCursor(b.line,0),a.replaceSelection("##### "+c),a.setCursor(b.line,b.ch+6)):a.replaceSelection("##### "+c)},h6:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();0!==b.ch?(a.setCursor(b.line,
0),a.replaceSelection("###### "+c),a.setCursor(b.line,b.ch+7)):a.replaceSelection("###### "+c)},"list-ul":function(){var a=this.cm;a.getCursor();var b=a.getSelection();if(""===b)a.replaceSelection("- "+b);else{b=b.split("\n");for(var c=0,d=b.length;c<d;c++)b[c]=""===b[c]?"":"- "+b[c];a.replaceSelection(b.join("\n"))}},"list-ol":function(){var a=this.cm;a.getCursor();var b=a.getSelection();if(""===b)a.replaceSelection("1. "+b);else{b=b.split("\n");for(var c=0,d=b.length;c<d;c++)b[c]=""===b[c]?"":c+
1+". "+b[c];a.replaceSelection(b.join("\n"))}},hr:function(){var a=this.cm,b=a.getCursor();a.getSelection();a.replaceSelection((0!==b.ch?"\n\n":"\n")+"------------\n\n")},tex:function(){if(!this.settings.tex)return alert("settings.tex === false"),this;var a=this.cm,b=a.getCursor(),c=a.getSelection();a.replaceSelection("$$"+c+"$$");""===c&&a.setCursor(b.line,b.ch+2)},link:function(){this.executePlugin("linkDialog","link-dialog/link-dialog")},"reference-link":function(){this.executePlugin("referenceLinkDialog",
"reference-link-dialog/reference-link-dialog")},pagebreak:function(){if(!this.settings.pageBreak)return alert("settings.pageBreak === false"),this;var a=this.cm;a.getSelection();a.replaceSelection("\r\n[========]\r\n")},image:function(){this.executePlugin("imageDialog","image-dialog/image-dialog")},code:function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();a.replaceSelection("`"+c+"`");""===c&&a.setCursor(b.line,b.ch+1)},"code-block":function(){this.executePlugin("codeBlockDialog","code-block-dialog/code-block-dialog")},
"preformatted-text":function(){this.executePlugin("preformattedTextDialog","preformatted-text-dialog/preformatted-text-dialog")},table:function(){this.executePlugin("tableDialog","table-dialog/table-dialog")},datetime:function(){var a=this.cm;a.getSelection();var b=this.settings.lang.name;b=d.dateFormat()+" "+d.dateFormat("zh-cn"===b||"zh-tw"===b?"cn-week-day":"week-day");a.replaceSelection(b)},emoji:function(){this.executePlugin("emojiDialog","emoji-dialog/emoji-dialog")},"html-entities":function(){this.executePlugin("htmlEntitiesDialog",
"html-entities-dialog/html-entities-dialog")},"goto-line":function(){this.executePlugin("gotoLineDialog","goto-line-dialog/goto-line-dialog")},watch:function(){this[this.settings.watch?"unwatch":"watch"]()},preview:function(){this.previewing()},fullscreen:function(){this.fullscreen()},clear:function(){this.clear()},search:function(){this.search()},gears:function(){this.executePlugin("gearsDialog","gears-dialog/gears-dialog")},help:function(){this.executePlugin("helpDialog","help-dialog/help-dialog")},
info:function(){this.showInfoDialog()}};d.keyMaps={"Ctrl-1":"h1","Ctrl-2":"h2","Ctrl-3":"h3","Ctrl-4":"h4","Ctrl-5":"h5","Ctrl-6":"h6","Ctrl-B":"bold","Ctrl-D":"datetime","Ctrl-E":function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();this.settings.emoji?(a.replaceSelection(":"+c+":"),""===c&&a.setCursor(b.line,b.ch+1)):alert("Error: settings.emoji == false")},"Ctrl-Alt-G":"goto-line","Ctrl-H":"hr","Ctrl-I":"italic","Ctrl-K":"code","Ctrl-L":function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();
a.replaceSelection("["+c+"]("+(""===c?"":' "'+c+'"')+")");""===c&&a.setCursor(b.line,b.ch+1)},"Ctrl-U":"list-ul","Shift-Ctrl-A":function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();this.settings.atLink?(a.replaceSelection("@"+c),""===c&&a.setCursor(b.line,b.ch+1)):alert("Error: settings.atLink == false")},"Shift-Ctrl-C":"code","Shift-Ctrl-Q":"quote","Shift-Ctrl-S":"del","Shift-Ctrl-K":"tex","Shift-Alt-C":function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();a.replaceSelection(["```",
c,"```"].join("\n"));""===c&&a.setCursor(b.line,b.ch+3)},"Shift-Ctrl-Alt-C":"code-block","Shift-Ctrl-H":"html-entities","Shift-Alt-H":"help","Shift-Ctrl-E":"emoji","Shift-Ctrl-U":"uppercase","Shift-Alt-U":"ucwords","Shift-Ctrl-Alt-U":"ucfirst","Shift-Alt-L":"lowercase","Shift-Ctrl-I":function(){var a=this.cm,b=a.getCursor(),c=a.getSelection();a.replaceSelection("!["+c+"]("+(""===c?"":' "'+c+'"')+")");""===c&&a.setCursor(b.line,b.ch+4)},"Shift-Ctrl-Alt-I":"image","Shift-Ctrl-L":"link","Shift-Ctrl-O":"list-ol",
"Shift-Ctrl-P":"preformatted-text","Shift-Ctrl-T":"table","Shift-Alt-P":"pagebreak",F9:"watch",F10:"preview",F11:"fullscreen"};var w=function(a){return String.prototype.trim?a.trim():a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};d.trim=w;d.ucwords=d.wordsFirstUpperCase=function(a){return a.toLowerCase().replace(/\b(\w)|\s(\w)/g,function(a){return a.toUpperCase()})};d.firstUpperCase=d.ucfirst=function(a){return a.toLowerCase().replace(/\b(\w)/,function(a){return a.toUpperCase()})};d.urls={atLinkBase:"https://github.com/"};
d.regexs={atLink:/@(\w+)/g,email:/(\w+)@(\w+)\.(\w+)\.?(\w+)?/g,emailLink:/(mailto:)?([\w\._]+)@(\w+)\.(\w+)\.?(\w+)?/g,emoji:/:([\w\+-]+):/g,emojiDatetime:/(\d{2}:\d{2}:\d{2})/g,twemoji:/:(tw-([\w]+)-?(\w+)?):/g,fontAwesome:/:(fa-([\w]+)(-(\w+)){0,}):/g,editormdLogo:/:(editormd-logo-?(\w+)?):/g,pageBreak:/^\[[=]{8,}\]$/};d.emoji={path:"https://www.webpagefx.com/tools/emoji-cheat-sheet/graphics/emojis/",ext:".png"};d.twemoji={path:"http://twemoji.maxcdn.com/36x36/",ext:".png"};d.markedRenderer=function(a,
b){var c=f.extend({toc:!0,tocm:!1,tocStartLevel:1,pageBreak:!0,atLink:!0,emailLink:!0,taskList:!1,emoji:!1,tex:!1,flowChart:!1,sequenceDiagram:!1},b||{}),e=d.$marked;b=new e.Renderer;a=a||[];var h=d.regexs,k=h.atLink,l=h.emoji,g=h.email,n=h.emailLink,p=h.twemoji,q=h.fontAwesome,m=h.editormdLogo,r=h.pageBreak;b.emoji=function(a){a=a.replace(d.regexs.emojiDatetime,function(a){return a.replace(/:/g,"&#58;")});var b=a.match(l);if(!b||!c.emoji)return a;for(var e=0,f=b.length;e<f;e++)":+1:"===b[e]&&(b[e]=
":\\+1:"),a=a.replace(new RegExp(b[e]),function(a,b){var c=a.match(q);b=a.replace(/:/g,"");if(c)for(b=c.length;0<b;)return b=c[0].replace(/:/g,""),'<i class="fa '+b+' fa-emoji" title="'+b.replace("fa-","")+'"></i>';else if(c=a.match(m),a=a.match(p),c)for(b=c.length;0<b;)return b=c[0].replace(/:/g,""),'<i class="'+b+'" title="Editor.md logo ('+b+')"></i>';else if(a)for(b=a.length;0<b;)return b=a[0].replace(/:/g,"").replace("tw-",""),'<img src="'+d.twemoji.path+b+d.twemoji.ext+'" title="twemoji-'+b+
'" alt="twemoji-'+b+'" class="emoji twemoji" />';else return a="+1"===b?"plus1":b,a="black_large_square"===a?"black_square":a,'<img src="'+d.emoji.path+("moon"===a?"waxing_gibbous_moon":a)+d.emoji.ext+'" class="emoji" title="&#58;'+b+'&#58;" alt="&#58;'+b+'&#58;" />'});return a};b.atLink=function(a){k.test(a)&&(c.atLink&&(a=a.replace(g,function(a,b,c,d){return a.replace(/@/g,"_#_&#64;_#_")}),a=a.replace(k,function(a,b){return'<a href="'+d.urls.atLinkBase+b+'" title="&#64;'+b+'" class="at-link">'+
a+"</a>"}).replace(/_#_&#64;_#_/g,"@")),c.emailLink&&(a=a.replace(n,function(a,b,c,d,e){return!b&&0>f.inArray(e,"jpg jpeg png gif webp ico icon pdf".split(" "))?'<a href="mailto:'+a+'">'+a+"</a>":a})));return a};b.link=function(a,b,c){if(this.options.sanitize){try{var d=decodeURIComponent(unescape(a)).replace(/[^\w:]/g,"").toLowerCase()}catch(x){return""}if(0===d.indexOf("javascript:"))return""}a='<a href="'+a+'"';if(k.test(b)||k.test(c))return b&&(a+=' title="'+b.replace(/@/g,"&#64;")),a+'">'+c.replace(/@/g,
"&#64;")+"</a>";b&&(a+=' title="'+b+'"');return a+(">"+c+"</a>")};b.heading=function(b,c,d){d=b;var e=/\s*<a\s*href="(.*)"\s*([^>]*)>(.*)<\/a>\s*/;if(e.test(b)){var f=[];b=b.split(/<a\s*([^>]+)>([^>]*)<\/a>/);for(var g=0,h=b.length;g<h;g++)f.push(b[g].replace(/\s*href="(.*)"\s*/g,""));b=f.join(" ")}b=w(b);f=b.toLowerCase().replace(/[^\w]+/g,"-");f={text:b,level:c,slug:f};g=/^[\u4e00-\u9fa5]+$/.test(b)?escape(b).replace(/%/g,""):b.toLowerCase().replace(/[^\w]+/g,"-");a.push(f);f="<h"+c+' id="h'+c+
"-"+this.options.headerPrefix+g+'">';f=f+('<a name="'+b+'" class="reference-link"></a>')+'<span class="header-link octicon octicon-link"></span>'+(e?this.atLink(this.emoji(d)):this.atLink(this.emoji(b)));return f+="</h"+c+">"};b.pageBreak=function(a){r.test(a)&&c.pageBreak&&(a='<hr style="page-break-after:always;" class="page-break editormd-page-break" />');return a};b.paragraph=function(a){var b=/\$\$(.*)\$\$/g.test(a),e=/^\$\$(.*)\$\$$/.test(a),f=e?' class="'+d.classNames.tex+'"':"",g=c.tocm?/^(\[TOC\]|\[TOCM\])$/.test(a):
/^\[TOC\]$/.test(a),h=/^\[TOCM\]$/.test(a);a=!e&&b?a.replace(/(\$\$([^\$]*)\$\$)+/g,function(a,b){return'<span class="'+d.classNames.tex+'">'+b.replace(/\$/g,"")+"</span>"}):e?a.replace(/\$/g,""):a;b='<div class="markdown-toc editormd-markdown-toc">'+a+"</div>";return g?h?'<div class="editormd-toc-menu">'+b+"</div><br/>":b:r.test(a)?this.pageBreak(a):"<p"+f+">"+this.atLink(this.emoji(a))+"</p>\n"};b.code=function(a,b,c){return"seq"===b||"sequence"===b?'<div class="sequence-diagram">'+a+"</div>":"flow"===
b?'<div class="flowchart">'+a+"</div>":"math"===b||"latex"===b||"katex"===b?'<p class="'+d.classNames.tex+'">'+a+"</p>":e.Renderer.prototype.code.apply(this,arguments)};b.tablecell=function(a,b){var c=b.header?"th":"td";return(b.align?"<"+c+' style="text-align:'+b.align+'">':"<"+c+">")+this.atLink(this.emoji(a))+"</"+c+">\n"};b.listitem=function(a){return c.taskList&&/^\s*\[[x\s]\]\s*/.test(a)?(a=a.replace(/^\s*\[\s\]\s*/,'<input type="checkbox" class="task-list-item-checkbox" /> ').replace(/^\s*\[x\]\s*/,
'<input type="checkbox" class="task-list-item-checkbox" checked disabled /> '),'<li style="list-style: none;">'+this.atLink(this.emoji(a))+"</li>"):"<li>"+this.atLink(this.emoji(a))+"</li>"};return b};d.markdownToCRenderer=function(a,b,c,d){var e="",f=0,l=this.classPrefix;d=d||1;for(var g=0,n=a.length;g<n;g++){var p=a[g].text,q=a[g].level;q<d||(e=q>f?e+"":q<f?e+Array(f-q+2).join("</ul></li>"):e+"</ul></li>",e+='<li><a class="toc-level-'+q+'" href="#'+p+'" level="'+q+'">'+p+"</a><ul>",f=q)}a=b.find(".markdown-toc");
1>a.length&&"false"===b.attr("previewContainer")&&(a='<div class="markdown-toc '+l+'markdown-toc"></div>',b.html(c?'<div class="'+l+'toc-menu">'+a+"</div>":a),a=b.find(".markdown-toc"));c&&a.wrap('<div class="'+l+'toc-menu"></div><br/>');a.html('<ul class="markdown-toc-list"></ul>').children(".markdown-toc-list").html(e.replace(/\r?\n?<ul><\/ul>/g,""));return a};d.tocDropdownMenu=function(a,b){b=b||"Table of Contents";var c=400;a=a.find("."+this.classPrefix+"toc-menu");a.each(function(){var a=f(this),
d=a.children(".markdown-toc"),k='<a href="javascript:;" class="toc-menu-btn"><i class="fa fa-angle-down"></i>'+b+"</a>",l=d.children("ul"),g=l.find("li");d.append(k);g.first().before("<li><h1>"+b+' <i class="fa fa-angle-down"></i></h1></li>');a.mouseover(function(){l.show();g.each(function(){var a=f(this),b=a.children("ul");""===b.html()&&b.remove();if(0<b.length&&""!==b.html()){var d=a.children("a").first();1>d.children(".fa").length&&d.append(f('<i class="fa fa-angle-down"></i>').css({float:"right",
paddingTop:"4px"}))}a.mouseover(function(){b.css("z-index",c).show();c+=1}).mouseleave(function(){b.hide()})})}).mouseleave(function(){l.hide()})});return a};d.filterHTMLTags=function(a,b){"string"!==typeof a&&(a=new String(a));if("string"!==typeof b)return a;var c=b.split("|");b=c[0].split(",");var d=c[1];c=0;for(var h=b.length;c<h;c++){var k=b[c];a=a.replace(new RegExp("<s*"+k+"s*([^>]*)>([^>]*)<s*/"+k+"s*>","igm"),"")}"undefined"!==typeof d&&(b=/<(\w+)\s*([^>]*)>([^>]*)<\/(\w+)>/ig,a="*"===d?a.replace(b,
function(a,b,c,d,e){return"<"+b+">"+d+"</"+e+">"}):"on*"===d?a.replace(b,function(a,b,c,d,e){b=f("<"+b+">"+d+"</"+e+">");a=f(a)[0].attributes;var g={};f.each(a,function(a,b){'"'!==b.nodeName&&(g[b.nodeName]=b.nodeValue)});f.each(g,function(a){0===a.indexOf("on")&&delete g[a]});b.attr(g);a="undefined"!==typeof b[1]?f(b[1]).text():"";return b[0].outerHTML+a}):a.replace(b,function(a,b,c,e){var g=d.split(","),h=f(a);h.html(e);f.each(g,function(a){h.attr(g[a],null)});return h[0].outerHTML}));return a};
d.markdownToHTML=function(a,b){d.$marked=marked;var c=f("#"+a);a=c.settings=f.extend(!0,{gfm:!0,toc:!0,tocm:!1,tocStartLevel:1,tocTitle:"\u76ee\u5f55",tocDropdown:!1,tocContainer:"",markdown:"",markdownSourceCode:!1,htmlDecode:!1,autoLoadKaTeX:!0,pageBreak:!0,atLink:!0,emailLink:!0,tex:!1,taskList:!1,emoji:!1,flowChart:!1,sequenceDiagram:!1,previewCodeHighlight:!0},b||{});var e=c.find("textarea");1>e.length&&(c.append("<textarea></textarea>"),e=c.find("textarea"));var h=""===a.markdown?e.val():a.markdown;
b=[];var k={renderer:d.markedRenderer(b,{toc:a.toc,tocm:a.tocm,tocStartLevel:a.tocStartLevel,taskList:a.taskList,emoji:a.emoji,tex:a.tex,pageBreak:a.pageBreak,atLink:a.atLink,emailLink:a.emailLink,flowChart:a.flowChart,sequenceDiagram:a.sequenceDiagram,previewCodeHighlight:a.previewCodeHighlight}),gfm:a.gfm,tables:!0,breaks:!0,pedantic:!1,sanitize:a.htmlDecode?!1:!0,smartLists:!0,smartypants:!0};h=new String(h);k=marked(h,k);k=d.filterHTMLTags(k,a.htmlDecode);a.markdownSourceCode?e.text(h):e.remove();
c.addClass("markdown-body "+this.classPrefix+"html-preview").append(k);h=""!==a.tocContainer?f(a.tocContainer):c;""!==a.tocContainer&&h.attr("previewContainer",!1);a.toc&&(c.tocContainer=this.markdownToCRenderer(b,h,a.tocDropdown,a.tocStartLevel),(a.tocDropdown||0<c.find("."+this.classPrefix+"toc-menu").length)&&this.tocDropdownMenu(c,a.tocTitle),""!==a.tocContainer&&c.find(".editormd-toc-menu, .editormd-markdown-toc").remove());a.previewCodeHighlight&&(c.find("pre").addClass("prettyprint linenums"),
prettyPrint());d.isIE8||(a.flowChart&&c.find(".flowchart").flowChart(),a.sequenceDiagram&&c.find(".sequence-diagram").sequenceDiagram({theme:"simple"}));if(a.tex){var l=function(){c.find("."+d.classNames.tex).each(function(){var a=f(this);katex.render(a.html().replace(/&lt;/g,"<").replace(/&gt;/g,">"),a[0]);a.find(".katex").css("font-size","1.6em")})};!a.autoLoadKaTeX||d.$katex||d.kaTeXLoaded?l():this.loadKaTeX(function(){d.$katex=katex;d.kaTeXLoaded=!0;l()})}c.getMarkdown=function(){return e.val()};
return c};d.themes=["default","dark"];d.previewThemes=["default","dark"];d.editorThemes="default 3024-day 3024-night ambiance ambiance-mobile base16-dark base16-light blackboard cobalt eclipse elegant erlang-dark lesser-dark mbo mdn-like midnight monokai neat neo night paraiso-dark paraiso-light pastel-on-dark rubyblue solarized the-matrix tomorrow-night-eighties twilight vibrant-ink xq-dark xq-light".split(" ");d.loadPlugins={};d.loadFiles={js:[],css:[],plugin:[]};d.loadPlugin=function(a,b,c){b=
b||function(){};this.loadScript(a,function(){d.loadFiles.plugin.push(a);b()},c)};d.loadCSS=function(a,b,c){c=c||"head";b=b||function(){};var e=document.createElement("link");e.type="text/css";e.rel="stylesheet";e.onload=e.onreadystatechange=function(){d.loadFiles.css.push(a);b()};e.href=a+".css";"head"===c?document.getElementsByTagName("head")[0].appendChild(e):document.body.appendChild(e)};d.isIE="Microsoft Internet Explorer"==navigator.appName;d.isIE8=d.isIE&&"8."==navigator.appVersion.match(/8./i);
d.loadScript=function(a,b,c){c=c||"head";b=b||function(){};var e=null;e=document.createElement("script");e.id=a.replace(/[\./]+/g,"-");e.type="text/javascript";e.src=a+".js";d.isIE8?e.onreadystatechange=function(){!e.readyState||"loaded"!==e.readyState&&"complete"!==e.readyState||(e.onreadystatechange=null,d.loadFiles.js.push(a),b())}:e.onload=function(){d.loadFiles.js.push(a);b()};"head"===c?document.getElementsByTagName("head")[0].appendChild(e):document.body.appendChild(e)};d.katexURL={css:"//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.3.0/katex.min",
js:"//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.3.0/katex.min"};d.kaTeXLoaded=!1;d.loadKaTeX=function(a){d.loadCSS(d.katexURL.css,function(){d.loadScript(d.katexURL.js,a||function(){})})};d.lockScreen=function(a){f("html,body").css("overflow",a?"hidden":"")};d.createDialog=function(a){a=f.extend(!0,{name:"",width:420,height:240,title:"",drag:!0,closed:!0,content:"",mask:!0,maskStyle:{backgroundColor:"#fff",opacity:.1},lockScreen:!0,footer:!0,buttons:!1},a);var b=this,c=this.editor,e=d.classPrefix,h=
(new Date).getTime(),k=""===a.name?e+"dialog-"+h:a.name;h=d.mouseOrTouch;var l='<div class="'+e+"dialog "+k+'">';""!==a.title&&(l+='<div class="'+e+'dialog-header"'+(a.drag?' style="cursor: move;"':"")+">",l+='<strong class="'+e+'dialog-title">'+a.title+"</strong>",l+="</div>");a.closed&&(l+='<a href="javascript:;" class="fa fa-close '+e+'dialog-close"></a>');l+='<div class="'+e+'dialog-container">'+a.content;if(a.footer||"string"===typeof a.footer)l+='<div class="'+e+'dialog-footer">'+("boolean"===
typeof a.footer?"":a.footer)+"</div>";c.append(l+"</div>"+('<div class="'+e+"dialog-mask "+e+'dialog-mask-bg"></div>')+('<div class="'+e+"dialog-mask "+e+'dialog-mask-con"></div>')+"</div>");var g=c.find("."+k);g.lockScreen=function(c){a.lockScreen&&(f("html,body").css("overflow",c?"hidden":""),b.resize());return g};g.showMask=function(){a.mask&&c.find("."+e+"mask").css(a.maskStyle).css("z-index",d.dialogZindex-1).show();return g};g.hideMask=function(){a.mask&&c.find("."+e+"mask").hide();return g};
g.loading=function(a){g.find("."+e+"dialog-mask")[a?"show":"hide"]();return g};g.lockScreen(!0).showMask();g.show().css({zIndex:d.dialogZindex,border:d.isIE8?"1px solid #ddd":"",width:"number"===typeof a.width?a.width+"px":a.width,height:"number"===typeof a.height?a.height+"px":a.height});k=function(){g.css({top:(f(window).height()-g.height())/2+"px",left:(f(window).width()-g.width())/2+"px"})};k();f(window).resize(k);g.children("."+e+"dialog-close").bind(h("click","touchend"),function(){g.hide().lockScreen(!1).hideMask()});
if("object"===typeof a.buttons){k=g.footer=g.find("."+e+"dialog-footer");for(var n in a.buttons){l=a.buttons[n];var p=e+n+"-btn";k.append('<button class="'+e+"btn "+p+'">'+l[0]+"</button>");l[1]=f.proxy(l[1],g);k.children("."+p).bind(h("click","touchend"),l[1])}}if(""!==a.title&&a.drag){var q,m;n=g.children("."+e+"dialog-header");a.mask||n.bind(h("click","touchend"),function(){d.dialogZindex+=2;g.css("z-index",d.dialogZindex)});n.mousedown(function(a){a=a||window.event;q=a.clientX-parseInt(g[0].style.left);
m=a.clientY-parseInt(g[0].style.top);document.onmousemove=u});var r=function(a){a.removeClass(e+"user-unselect").off("selectstart")},t=function(a){a.addClass(e+"user-unselect").on("selectstart",function(a){return!1})},u=function(a){a=a||window.event;var b=parseInt(g[0].style.left);var c=parseInt(g[0].style.top);0<=b?b+g.width()<=f(window).width()?b=a.clientX-q:(b=f(window).width()-g.width(),document.onmousemove=null):(b=0,document.onmousemove=null);0<=c?a=a.clientY-m:(a=0,document.onmousemove=null);
document.onselectstart=function(){return!1};t(f("body"));t(g);g[0].style.left=b+"px";g[0].style.top=a+"px"};document.onmouseup=function(){r(f("body"));r(g);document.onselectstart=null;document.onmousemove=null};n.touchDraggable=function(){var a=null;this.bind("touchstart",function(b){b=b.originalEvent;var c=f(this).parent().position();a={x:b.changedTouches[0].pageX-c.left,y:b.changedTouches[0].pageY-c.top}}).bind("touchmove",function(b){b.preventDefault();b=b.originalEvent;f(this).parent().css({top:b.changedTouches[0].pageY-
a.y,left:b.changedTouches[0].pageX-a.x})})};n.touchDraggable()}d.dialogZindex+=2;return g};d.mouseOrTouch=function(a,b){b=b||"touchend";a=a||"click";try{document.createEvent("TouchEvent"),a=b}catch(c){}return a};d.dateFormat=function(a){a=a||"";var b=function(a){return 10>a?"0"+a:a},c=new Date,d=c.getFullYear(),f=d.toString().slice(2,4),k=b(c.getMonth()+1),l=b(c.getDate()),g=c.getDay(),n=b(c.getHours()),p=b(c.getMinutes()),q=b(c.getSeconds());b=b(c.getMilliseconds());var m="";m=f+"-"+k+"-"+l;var r=
d+"-"+k+"-"+l,t=n+":"+p+":"+q;switch(a){case "UNIX Time":m=c.getTime();break;case "UTC":m=c.toUTCString();break;case "yy":m=f;break;case "year":case "yyyy":m=d;break;case "month":case "mm":m=k;break;case "cn-week-day":case "cn-wd":m="\u661f\u671f"+"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split("")[g];break;case "week-day":case "wd":m="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ")[g];break;case "day":case "dd":m=l;break;case "hour":case "hh":m=n;break;case "min":case "ii":m=
p;break;case "second":case "ss":m=q;break;case "ms":m=b;break;case "yy-mm-dd":break;case "yyyy-mm-dd":m=r;break;case "yyyy-mm-dd h:i:s ms":case "full + ms":m=r+" "+t+" "+b;break;default:m=r+" "+t}return m};return d}});